const int LED1_PIN = 9;
const int LED2_PIN = 10;
const int LED3_PIN = 11;

const int BUTTON1_PIN = 2;
const int BUTTON2_PIN = 3;
const int BUTTON3_PIN = 4;

unsigned long lastPrintTime = 0;
const unsigned long PRINT_INTERVAL = 1000;

void setup() {
  DDRB |= (1 << DDB1);
  DDRB |= (1 << DDB2);
  DDRB |= (1 << DDB3);
  
  DDRD &= ~(1 << DDD2);
  PORTD |= (1 << PORTD2);
  DDRD &= ~(1 << DDD3);
  PORTD |= (1 << PORTD3);
  DDRD &= ~(1 << DDD4);
  PORTD |= (1 << PORTD4);
  
  Serial.begin(9600);
}

void printBinary(byte value) {
  Serial.print("B");
  for (int i = 7; i >= 0; i--) {
    Serial.print(bitRead(value, i));
  }
}

void loop() {
  int button1State = PIND & (1 << PIND2);
  int button2State = PIND & (1 << PIND3);
  int button3State = PIND & (1 << PIND4);
  
  if (button1State == 0) {
    PORTB |= (1 << PORTB1);
  } else {
    PORTB &= ~(1 << PORTB1);
  }
  
  if (button2State == 0) {
    PORTB |= (1 << PORTB2);
  } else {
    PORTB &= ~(1 << PORTB2);
  }
  
  if (button3State == 0) {
    PORTB |= (1 << PORTB3);
  } else {
    PORTB &= ~(1 << PORTB3);
  }
  
  if (millis() - lastPrintTime >= PRINT_INTERVAL) {
    byte portDState = PIND;
    
    Serial.print("PIND ");
    printBinary(portDState);
    Serial.print(" | Единицы в битах: ");
    
    boolean found = false;
    for (int i = 0; i < 8; i++) {
      if (portDState & (1 << i)) {
        if (found) Serial.print(", ");
        Serial.print(i);
        found = true;
      }
    }
    
    if (!found) {
      Serial.print("нет");
    }
    
    Serial.print(" | Кнопки: ");
    
    if (!(portDState & (1 << PIND2))) Serial.print("1 ");
    if (!(portDState & (1 << PIND3))) Serial.print("2 ");
    if (!(portDState & (1 << PIND4))) Serial.print("3 ");
    
    Serial.println();
    
    lastPrintTime = millis();
  }
  
  delay(50);
}
